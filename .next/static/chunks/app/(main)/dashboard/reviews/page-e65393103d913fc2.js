(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7902],{29866:(e,s,r)=>{Promise.resolve().then(r.bind(r,42177))},42177:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>C});var a=r(51047),t=r(76847),i=r(15343),l=r(92784),n=r(18062),d=r(39077),c=r(21366),o=r(50225),m=r(84668),u=r(24566),x=r(43595),h=r(96842),f=r(51500),p=r(27167),v=r(72345),j=r(79730);let y=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500,[r,a]=(0,t.useState)(e);return(0,t.useEffect)(()=>{let r=setTimeout(()=>a(e),s);return()=>{clearTimeout(r)}},[e,s]),r},g=e=>{let{data:s,currentPage:r=1,onPageChange:i,searchTerm:n="",onSearchTermChange:d,isLoading:c=!1,onRespondToReview:g}=e,[N,b]=(0,t.useState)(null),[R,w]=(0,t.useState)(""),[S,C]=(0,t.useState)(!1);y(n,500);let A=async()=>{if(N&&R.trim())try{C(!0),await g(N.id,R),w(""),b(null)}finally{C(!1)}},T=e=>(0,a.jsx)("div",{className:"flex items-center",children:[1,2,3,4,5].map(s=>(0,a.jsx)("span",{className:"text-xl ".concat(s<=e?"text-yellow-500":"text-gray-300"),children:"â˜…"},s))});return(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsxs)("div",{className:"relative w-full max-w-md",children:[(0,a.jsx)(u.A,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-gray-400"}),(0,a.jsx)(m.p,{placeholder:"Search reviews...",className:"pl-10",value:n,onChange:e=>d(e.target.value)})]})}),c?(0,a.jsx)("div",{className:"space-y-4",children:[void 0,void 0,void 0,void 0,void 0].map((e,s)=>(0,a.jsx)(v.E,{className:"h-20 w-full"},s))}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"rounded-md border",children:(0,a.jsxs)(f.XI,{children:[(0,a.jsx)(f.A0,{children:(0,a.jsxs)(f.Hj,{children:[(0,a.jsx)(f.nd,{children:"Product"}),(0,a.jsx)(f.nd,{children:"User"}),(0,a.jsx)(f.nd,{children:"Rating"}),(0,a.jsx)(f.nd,{children:"Comment"}),(0,a.jsx)(f.nd,{children:"Date"}),(0,a.jsx)(f.nd,{children:"Response"}),(0,a.jsx)(f.nd,{children:"Actions"})]})}),(0,a.jsx)(f.BF,{children:s.results.map(e=>(0,a.jsxs)(f.Hj,{children:[(0,a.jsx)(f.nA,{children:(0,a.jsx)("div",{className:"font-medium",children:e.productModel.name})}),(0,a.jsxs)(f.nA,{children:[(0,a.jsxs)("div",{className:"font-medium",children:[e.user.firstName," ",e.user.lastName]}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:e.user.email})]}),(0,a.jsx)(f.nA,{children:T(e.rating)}),(0,a.jsx)(f.nA,{className:"max-w-xs truncate",children:e.comment}),(0,a.jsx)(f.nA,{children:new Date(e.createdAt).toLocaleDateString()}),(0,a.jsx)(f.nA,{children:e.ReviewResponse?(0,a.jsx)(o.E,{variant:"outline",className:"border-green-500",children:"Responded"}):(0,a.jsx)(o.E,{variant:"outline",children:"Pending"})}),(0,a.jsx)(f.nA,{children:(0,a.jsxs)(l.$,{variant:"ghost",size:"sm",onClick:()=>b(e),children:[(0,a.jsx)(x.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"ml-2",children:"View"})]})})]},e.id))})]})}),s.totalPages>1&&(0,a.jsx)(p.A,{currentPage:r,totalPages:s.totalPages,onPageChange:i,activeClassName:"bg-primary text-primary-foreground hover:bg-primary/90",prevLabel:"Previous",nextLabel:"Next",delta:1,className:"rounded-md"})]}),(0,a.jsx)(h.cj,{open:!!N,onOpenChange:e=>!e&&b(null),children:(0,a.jsx)(h.h,{className:"w-full sm:max-w-2xl overflow-y-auto",children:N&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(h.Fm,{children:[(0,a.jsx)(h.qp,{children:"Review Details"}),(0,a.jsxs)(h.Qs,{children:["Review for ",N.productModel.name," from"," ",N.user.firstName," ",N.user.lastName]})]}),(0,a.jsxs)("div",{className:"space-y-4 py-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"font-medium",children:[N.user.firstName," ",N.user.lastName]}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:N.user.email})]}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:new Date(N.createdAt).toLocaleDateString()})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[T(N.rating),(0,a.jsxs)("span",{className:"text-sm text-gray-500",children:[N.rating.toFixed(1),"/5"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium",children:"Product"}),(0,a.jsx)("p",{children:N.productModel.name})]}),(0,a.jsxs)("div",{className:"rounded-md border p-4",children:[(0,a.jsx)("h4",{className:"font-medium mb-2",children:"Review Comment"}),(0,a.jsx)("p",{className:"whitespace-pre-line",children:N.comment})]}),N.images.length>0&&(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsx)("h4",{className:"font-medium mb-2",children:"Images"}),(0,a.jsx)("div",{className:"grid grid-cols-3 gap-2",children:N.images.map(e=>(0,a.jsx)("img",{src:e.optimizeUrl||e.uploadUrl,alt:"Review",className:"rounded-md object-cover h-24 w-full"},e.id))})]}),N.ReviewResponse&&(0,a.jsxs)("div",{className:"mt-6 space-y-2",children:[(0,a.jsx)("h4",{className:"font-medium",children:"Your Response"}),(0,a.jsxs)("div",{className:"rounded-md border p-4 bg-gray-50",children:[(0,a.jsx)("div",{className:"flex justify-between items-start",children:(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"font-medium",children:[N.ReviewResponse.user.firstName," ",N.ReviewResponse.user.lastName]}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:new Date(N.ReviewResponse.createdAt).toLocaleDateString()})]})}),(0,a.jsx)("p",{className:"mt-2 whitespace-pre-line",children:N.ReviewResponse.message})]})]}),!N.ReviewResponse&&(0,a.jsxs)("div",{className:"mt-6 space-y-2",children:[(0,a.jsx)("h4",{className:"font-medium",children:"Respond to Review"}),(0,a.jsx)(j.T,{value:R,onChange:e=>w(e.target.value),placeholder:"Write your response here...",rows:4}),(0,a.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,a.jsx)(l.$,{variant:"outline",onClick:()=>b(null),children:"Cancel"}),(0,a.jsx)(l.$,{onClick:A,disabled:!R.trim()||S,children:S?"Sending...":"Send Response"})]})]})]})]})})})]})};var N=r(35672);let b=(0,N.createServerReference)("60e0ba63f5cf5f353e81b866af3df53b141d3b78f2",N.callServer,void 0,N.findSourceMapURL,"RespondToReview");var R=r(49369),w=r(66368),S=r(53869);let C=()=>{let[e,s]=(0,t.useState)(1),[r,o]=(0,t.useState)(""),[m,u]=(0,t.useState)(0),[x,h]=(0,t.useState)(null),[f,p]=(0,t.useState)(!1),[v,j]=(0,t.useState)(!1),{data:y,isLoading:N,error:C,refetch:A}=(0,S.v1)({page:e,limit:10,searchTerm:r,refreshTrigger:m}),T=()=>{u(e=>e+1),A()},L=async(e,s)=>{h({reviewId:e,message:s}),p(!0)},q=async()=>{if(x){j(!0);try{let{success:e,message:s}=await b(x.reviewId,x.message);e?(R.oR.success("Response submitted successfully"),A()):R.oR.error(s||"Failed to submit response")}catch(e){R.oR.error("An unexpected error occurred"),console.error("Error responding to review:",e)}finally{j(!1),p(!1),h(null)}}};if(C)return(0,a.jsx)(i.A,{children:(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-xl text-red-500",children:"Error fetching reviews"}),(0,a.jsx)(l.$,{onClick:T,className:"mt-4",children:"Try Again"})]})})});let k=(null==y?void 0:y.data)||{page:1,limit:10,totalPages:1,totalResults:0,results:[]};return(0,a.jsx)(i.A,{scrollable:!1,children:(0,a.jsxs)("div",{className:"flex flex-1 flex-col space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsx)(n.D,{title:"Reviews",description:"Manage reviews"}),(0,a.jsx)("div",{className:"flex items-center space-x-4",children:(0,a.jsxs)(l.$,{variant:"outline",onClick:T,children:[(0,a.jsx)(c.A,{className:"mr-2 h-4 w-4"}),"Refresh"]})})]}),(0,a.jsx)(d.Separator,{}),(0,a.jsx)(g,{data:k,currentPage:e,onPageChange:e=>{s(e)},searchTerm:r,onSearchTermChange:e=>{o(e),s(1)},isLoading:N,onRespondToReview:L}),(0,a.jsx)(w.lG,{open:f,onOpenChange:p,children:(0,a.jsxs)(w.Cf,{children:[(0,a.jsxs)(w.c7,{children:[(0,a.jsx)(w.L3,{children:"Confirm Response"}),(0,a.jsx)(w.rr,{children:"Are you sure you want to send this response?"})]}),(0,a.jsxs)("div",{className:"py-4",children:[(0,a.jsx)("p",{className:"font-medium",children:"Response Preview:"}),(0,a.jsx)("p",{className:"mt-2 text-sm text-gray-600 bg-gray-50 p-3 rounded",children:null==x?void 0:x.message})]}),(0,a.jsxs)(w.Es,{children:[(0,a.jsx)(l.$,{variant:"outline",onClick:()=>p(!1),disabled:v,children:"Cancel"}),(0,a.jsx)(l.$,{onClick:q,disabled:v,children:v?"Sending...":"Confirm Send"})]})]})})]})})}},96842:(e,s,r)=>{"use strict";r.d(s,{Fm:()=>f,Qs:()=>v,cj:()=>c,h:()=>h,kN:()=>o,qp:()=>p});var a=r(51047),t=r(76847),i=r(42399),l=r(87285),n=r(71386),d=r(89039);let c=i.bL;i.l9;let o=i.bm,m=i.ZL,u=t.forwardRef((e,s)=>{let{className:r,...t}=e;return(0,a.jsx)(i.hJ,{className:(0,d.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",r),...t,ref:s})});u.displayName=i.hJ.displayName;let x=(0,l.F)("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500 data-[state=open]:animate-in data-[state=closed]:animate-out",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4 border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),h=t.forwardRef((e,s)=>{let{side:r="right",className:t,children:l,...c}=e;return(0,a.jsxs)(m,{children:[(0,a.jsx)(u,{}),(0,a.jsxs)(i.UC,{ref:s,className:(0,d.cn)(x({side:r}),t),...c,children:[(0,a.jsxs)(i.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[(0,a.jsx)(n.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]}),l]})]})});h.displayName=i.UC.displayName;let f=e=>{let{className:s,...r}=e;return(0,a.jsx)("div",{className:(0,d.cn)("flex flex-col space-y-2 text-center sm:text-left",s),...r})};f.displayName="SheetHeader";let p=t.forwardRef((e,s)=>{let{className:r,...t}=e;return(0,a.jsx)(i.hE,{ref:s,className:(0,d.cn)("text-lg font-semibold text-foreground",r),...t})});p.displayName=i.hE.displayName;let v=t.forwardRef((e,s)=>{let{className:r,...t}=e;return(0,a.jsx)(i.VY,{ref:s,className:(0,d.cn)("text-sm text-muted-foreground",r),...t})});v.displayName=i.VY.displayName},72345:(e,s,r)=>{"use strict";r.d(s,{E:()=>i});var a=r(51047),t=r(89039);function i(e){let{className:s,...r}=e;return(0,a.jsx)("div",{className:(0,t.cn)("animate-pulse rounded-md bg-primary/10",s),...r})}},79730:(e,s,r)=>{"use strict";r.d(s,{T:()=>l});var a=r(51047),t=r(76847),i=r(89039);let l=t.forwardRef((e,s)=>{let{className:r,...t}=e;return(0,a.jsx)("textarea",{className:(0,i.cn)("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),ref:s,...t})});l.displayName="Textarea"},53869:(e,s,r)=>{"use strict";r.d(s,{sx:()=>v,v1:()=>b,Wh:()=>p,tW:()=>j,LZ:()=>h,NG:()=>f,KT:()=>g,pL:()=>y,T3:()=>N});var a=r(63904),t=r(35672);let i=(0,t.createServerReference)("008423b04c3c33227903c470d3cff571d55f185440",t.callServer,void 0,t.findSourceMapURL,"userRegistrationsReport"),l=(0,t.createServerReference)("00af1931a66c287c47e00c3b33a6ce1534b6ffd621",t.callServer,void 0,t.findSourceMapURL,"verifiedUsersReport"),n=(0,t.createServerReference)("007668b11e9b330b4159c5f6690b228dbc86f02b2d",t.callServer,void 0,t.findSourceMapURL,"salesSummaryReport"),d=(0,t.createServerReference)("0018fb6c375168139d5b79215b9cf73578ac0ed31f",t.callServer,void 0,t.findSourceMapURL,"orderStatusReport"),c=(0,t.createServerReference)("0019014aa2c3b0f4cf1b973f689d4a74cd2641374d",t.callServer,void 0,t.findSourceMapURL,"topProductsReport"),o=(0,t.createServerReference)("409b89e37fa59de83190c69085f32c67bee1981a5a",t.callServer,void 0,t.findSourceMapURL,"lowInStockReport"),m=(0,t.createServerReference)("005176bed0b0eadb821d3344149d03459a56f29351",t.callServer,void 0,t.findSourceMapURL,"wishlistsTrendsReport"),u=(0,t.createServerReference)("004806823257b1c4915b79b6b340611a69633f5b84",t.callServer,void 0,t.findSourceMapURL,"technicianRegistrationReport"),x=(0,t.createServerReference)("404e21c85dd112e58484e6f71981dbf9cd67cf6633",t.callServer,void 0,t.findSourceMapURL,"getAllReviewsAction"),h=()=>(0,a.I)({queryKey:["user-registration-report"],queryFn:()=>i(),staleTime:0,retry:2}),f=()=>(0,a.I)({queryKey:["verified-user-report"],queryFn:()=>l(),staleTime:0,retry:2}),p=()=>(0,a.I)({queryKey:["sales-summary-report"],queryFn:()=>n(),staleTime:0,retry:2}),v=()=>(0,a.I)({queryKey:["order-status-report"],queryFn:()=>d(),staleTime:0,retry:2}),j=()=>(0,a.I)({queryKey:["top-products-report"],queryFn:()=>c(),staleTime:0,retry:2}),y=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return(0,a.I)({queryKey:["low-in-stock-report",e],queryFn:()=>o(e),staleTime:0,retry:2})},g=()=>(0,a.I)({queryKey:["wishlists-trends-report"],queryFn:()=>m(),staleTime:0,retry:2}),N=()=>(0,a.I)({queryKey:["technician-registration-report"],queryFn:()=>u(),staleTime:0,retry:2});function b(e){let{page:s=1,limit:r=10,searchTerm:t="",refreshTrigger:i=0}=e;return(0,a.I)({queryKey:["reviews",{page:s,limit:r,searchTerm:t,refreshTrigger:i}],queryFn:()=>x({page:s,limit:r,searchTerm:t}),staleTime:6e4})}}},e=>{var s=s=>e(e.s=s);e.O(0,[9632,6796,7584,6629,9369,3904,3795,9175,5721,9059,7358],()=>s(29866)),_N_E=e.O()}]);